<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>English Games</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
        body {
          margin: 0;
          font-family: Arial, sans-serif;
          background: linear-gradient(135deg, #89f7fe, #66a6ff);
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 100vh;
          overflow: hidden;
        }

        /* –°—Ç–∏–ª–∏ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ */
        .menu-container {
          text-align: center;
          padding: 20px;
          max-width: 500px;
        }

        .game-title {
          font-size: 24px;
          color: #fff;
          margin-bottom: 30px;
          text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .game-button {
          background: #007bff;
          color: white;
          border: none;
          padding: 15px 30px;
          margin: 10px;
          border-radius: 25px;
          font-size: 18px;
          cursor: pointer;
          transition: all 0.3s ease;
          width: 80%;
          max-width: 300px;
          box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .exit-button {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: #dc3545;
          color: white;
          padding: 10px 20px;
          border-radius: 20px;
          cursor: pointer;
          z-index: 1000;
          box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .game-button:hover {
          background: #0056b3;
          transform: translateY(-2px);
          box-shadow: 0 6px 8px rgba(0,0,0,0.2);
        }

        /* –°—Ç–∏–ª–∏ –∏–≥—Ä—ã (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç—ã) */
        .game-container {
          display: none;
          width: 100%;
          align-items: center;
          flex-direction: column;
        }

        .score-board {
          font-size: 20px;
          margin-bottom: 10px;
          color: #fff;
        }

        #gameCanvas {
          border: 2px solid #ccc;
          border-radius: 8px;
          box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal-background {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          background: rgba(0,0,0,0.5);
          display: none;
          align-items: center;
          justify-content: center;
          z-index: 1000;
        }

        .modal-content {
          background: #fff;
          border-radius: 8px;
          width: 400px;
          max-width: 90%;
          padding: 20px;
          box-shadow: 0 0 10px rgba(0,0,0,0.2);
          text-align: center;
        }

        .modal-content h2 {
          margin-bottom: 15px;
        }

        .modal-content .question-text {
          font-size: 16px;
          margin-bottom: 15px;
          min-height: 50px;
        }

        .modal-content input[type="text"] {
          width: 80%;
          padding: 8px;
          font-size: 14px;
          margin-bottom: 10px;
        }

        .modal-content .buttons {
          display: flex;
          gap: 10px;
          justify-content: center;
          margin-top: 10px;
        }

        .modal-content button {
          cursor: pointer;
          border: none;
          padding: 8px 16px;
          border-radius: 4px;
          background: #007bff;
          color: #fff;
          font-size: 14px;
          transition: background-color 0.2s;
        }

        .modal-content button:hover {
          background: #0056b3;
        }

        .modal-content .result-message {
          margin-top: 10px;
          min-height: 20px;
          font-size: 14px;
        }
        .modal-verbs-game {
            width: 90%;
            max-width: 600px;
            padding: 20px;
        }

        .question-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .drop-zone {
            display: inline-block;
            width: 80px;
            height: 30px;
            border: 2px dashed #007bff;
            border-radius: 5px;
            margin: 0 5px;
            vertical-align: middle;
        }

        .answers-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
        }

        .answer-option {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: move;
            user-select: none;
        }

        .correct {
            background: #28a745 !important;
        }

        .wrong {
            background: #dc3545 !important;
        }

        .feedback {
            margin-top: 10px;
            font-weight: bold;
            min-height: 20px;
        }
        .score-board {
    display: flex;
    gap: 15px;
}
    </style>
</head>
<body>
<!-- –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –∏–≥—Ä—ã -->
<div class="menu-container" id="menuContainer">
    <h1 class="game-title">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ</h1>
    <button class="game-button" onclick="startGame('snake')">üêç –ì—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ó–º–µ–π–∫–∞</button>
    <button class="game-button" onclick="startGame('modal')">üÉè –ú–æ–¥–∞–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã</button>
</div>

<!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞ –≤ –∏–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
<div class="game-container" id="gameContainer">
    <div class="score-board">
        <span id="scoreBoard">Score: 0</span> |
        <span id="bestScore">Best: 0</span>
    </div>
    <div class="modal-verbs-game" id="modalVerbsGame"></div>
    <canvas id="gameCanvas" width="800" height="500"></canvas>
    <div class="exit-button" onclick="showMenu()">–í—ã–π—Ç–∏ –≤ –º–µ–Ω—é</div>
</div>


<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ -->
<div class="modal-background" id="modalBg">
    <div class="modal-content">
        <h2>Answer the question</h2>
        <div class="question-text" id="questionText"></div>
        <input type="text" id="userAnswer" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
        <div class="result-message" id="resultMessage"></div>
        <div class="buttons">
            <button id="checkBtn">Check</button>
            <button id="closeBtn">Close</button>
        </div>
    </div>
</div>

<script>
    // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã —Å –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –≥–ª–∞–≥–æ–ª–∞–º–∏
    const modalVerbsData = [
        {
            question: "______ you see anything in the dark room?",
            correct: "can",
            options: ["can", "may"]
        },
        {
            question: "Kate ______ speak English.",
            correct: "can",
            options: ["can", "may"]
        },
    ];

    let currentQuestionIndex = 0;
    let score = parseInt(sessionStorage.getItem('currentScore')) || 0; // –ò–∑–º–µ–Ω–µ–Ω–æ: –ø–æ–ª—É—á–∞–µ–º –∏–∑ sessionStorage
    let bestScore = parseInt(localStorage.getItem('bestScore')) || 0;

    // –î–æ–±–∞–≤–ª–µ–Ω–æ: —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—á–µ—Ç–∞
    function updateScoreDisplay() {
        document.getElementById('scoreBoard').textContent = `Score: ${score}`;
        document.getElementById('bestScore').textContent = `Best: ${bestScore}`;
    }

    // –î–æ–±–∞–≤–ª–µ–Ω–æ: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    updateScoreDisplay();

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    function updateBestScore() {
        if(score > bestScore) {
            bestScore = score;
            localStorage.setItem('bestScore', bestScore);
            document.getElementById('bestScore').textContent = `Best: ${bestScore}`;
        }
    }

    function initializeModalGame() {
            const gameContainer = document.getElementById('modalVerbsGame');
            gameContainer.innerHTML = '';

            if(currentQuestionIndex >= modalVerbsData.length) {
                endModalGame();
                return;
            }

            const questionData = modalVerbsData[currentQuestionIndex];
            const questionElement = document.createElement('div');
            questionElement.className = 'question-container';

            // –°–æ–∑–¥–∞–µ–º –≤–æ–ø—Ä–æ—Å —Å –ø—Ä–æ–ø—É—Å–∫–æ–º
            const questionParts = questionData.question.split('______');
            questionElement.innerHTML = `
                <div class="question-text">
                    ${questionParts[0]}
                    <div class="drop-zone"
                        ondrop="dropHandler(event)"
                        ondragover="allowDrop(event)"
                        data-correct="${questionData.correct.toLowerCase()}">
                    </div>
                    ${questionParts[1]}
                </div>
                <div class="answers-container">
                    ${questionData.options.map(opt => `
                        <div class="answer-option"
                            draggable="true"
                            ondragstart="dragHandler(event)"
                            data-value="${opt.toLowerCase()}">
                            ${opt}
                        </div>
                    `).join('')}
                </div>
                <div class="feedback" id="feedback"></div>
            `;

            gameContainer.appendChild(questionElement);
        }

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function dragHandler(ev) {
            const value = ev.target.getAttribute('data-value');
            ev.dataTransfer.setData("text", value);
        }

        function dropHandler(ev) {
            ev.preventDefault();
            const data = ev.dataTransfer.getData("text");
            const dropZone = ev.target.closest('.drop-zone');

            if (!dropZone || dropZone.children.length > 0) return;

            const correctAnswer = dropZone.getAttribute('data-correct');
            const userAnswer = data.toLowerCase();

            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
            const answerDisplay = document.createElement('div');
            answerDisplay.textContent = data;
            answerDisplay.className = `answer-option ${userAnswer === correctAnswer ? 'correct' : 'wrong'}`;

            dropZone.appendChild(answerDisplay);
            dropZone.style.borderStyle = 'solid';

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç
            if(userAnswer === correctAnswer) {
                score++;
                document.getElementById('scoreBoard').textContent = `Score: ${score}`;
                document.getElementById('feedback').innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! +1 –±–∞–ª–ª';
                document.getElementById('feedback').style.color = '#28a745';

                setTimeout(() => {
                    currentQuestionIndex++;
                    initializeModalGame();
                }, 1500);
            } else {
                document.getElementById('feedback').innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë';
                document.getElementById('feedback').style.color = '#dc3545';

                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
                setTimeout(() => {
                    dropZone.innerHTML = '';
                    dropZone.style.borderStyle = 'dashed';
                }, 1000);
            }
        }

        function endModalGame() {
            updateBestScore();
            sessionStorage.removeItem('currentScore'); // –î–æ–±–∞–≤–ª–µ–Ω–æ: –æ—á–∏—Å—Ç–∫–∞ sessionStorage
            const resultData = {
                game: currentGame,
                bestScore: bestScore  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–º–µ—Å—Ç–æ —Ç–µ–∫—É—â–µ–≥–æ —Å—á–µ—Ç–∞
            };

            if(typeof Telegram !== 'undefined' && Telegram.WebApp) {
                Telegram.WebApp.sendData(JSON.stringify(resultData));
            }

            document.getElementById('modalVerbsGame').innerHTML = `
                <div class="question-container">
                    <h2>–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
                    <p>–í—ã –Ω–∞–±—Ä–∞–ª–∏ ${score} –±–∞–ª–ª–æ–≤ –∏–∑ ${modalVerbsData.length}</p>
                </div>
            `;
        }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é startGame
    function startGame(gameType) {
        currentGame = gameType;
        menuContainer.style.display = 'none';
        gameContainer.style.display = 'flex';

        if(gameType === 'snake') {
            initializeSnakeGame();
        } else if(gameType === 'modal') {
            updateScoreDisplay();
            initializeModalGame();
        }
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é showMenu
    function showMenu() {
        if(confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –≤ –º–µ–Ω—é?')) {
            menuContainer.style.display = 'block';
            gameContainer.style.display = 'none';
            if(currentGame === 'snake' && snakeGameInterval) {
                clearInterval(snakeGameInterval);
            }
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä
            currentQuestionIndex = 0;
        }
    }



    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é –∏ –∏–≥—Ä–æ–π
    let currentGame = null;
    const menuContainer = document.getElementById('menuContainer');
    const gameContainer = document.getElementById('gameContainer');
    let snakeGameInterval;

    function startGame(gameType) {
      currentGame = gameType;
      menuContainer.style.display = 'none';
      gameContainer.style.display = 'flex';

      if(gameType === 'snake') {
        initializeSnakeGame();
    } else if(gameType === 'modal') {
        initializeModalGame();
    } else {
        alert('–≠—Ç–∞ –∏–≥—Ä–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!');
        showMenu();
    }
    }

// –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é closeModal
    function closeModal() {
      modalBg.style.display = 'none';
      currentTaskIndex = null;
      gamePaused = false; // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä—É –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    }
    // –ö–æ–¥ –∑–º–µ–π–∫–∏
    function initializeSnakeGame() {
      const canvas = document.getElementById('gameCanvas');
      const ctx = canvas.getContext('2d');
      const internalWidth = 800, internalHeight = 500;
      canvas.width = internalWidth;
      canvas.height = internalHeight;

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è canvas
      function resizeCanvas() {
        const availableWidth = window.innerWidth - 40;
        const availableHeight = window.innerHeight - 150;
        const aspectRatio = internalWidth / internalHeight;
        let newWidth = availableWidth;
        let newHeight = newWidth / aspectRatio;
        if (newHeight > availableHeight) {
          newHeight = availableHeight;
          newWidth = newHeight * aspectRatio;
        }
        canvas.style.width = newWidth + 'px';
        canvas.style.height = newHeight + 'px';
      }

      window.addEventListener('resize', resizeCanvas);
      resizeCanvas();

      // –≠–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      const scoreBoard = document.getElementById('scoreBoard');
      const modalBg = document.getElementById('modalBg');
      const questionText = document.getElementById('questionText');
      const userAnswer = document.getElementById('userAnswer');
      const resultMessage = document.getElementById('resultMessage');
      const checkBtn = document.getElementById('checkBtn');
      const closeBtn = document.getElementById('closeBtn');

      // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã
      const cellSize = 20;
      let gameSpeed = 150;
      let snake = [
        {x: 5, y: 5},
        {x: 4, y: 5},
        {x: 3, y: 5}
      ];
      let direction = {x: 1, y: 0};
      let nextDirection = direction;
      let gamePaused = false;
      let gameOver = false;
      updateScoreDisplay();
      // –ó–∞–¥–∞–Ω–∏—è
      const tasksData = [
        {question: "She ___ (to go) to school every day.", correct: "goes", percX: 20, percY: 30},
        {question: "They ___ (to eat) dinner at 7 PM yesterday.", correct: "ate", percX: 70, percY: 50},
        {question: "I ___ (to be) very happy last week.", correct: "was", percX: 40, percY: 80},
        {question: "He ___ (to work) in the garden right now.", correct: "is working", percX: 85, percY: 20},
        {question: "We ___ (to see) that movie already.", correct: "have seen", percX: 10, percY: 60}
      ];
      const tasks = tasksData.map(task => ({
        question: task.question,
        correct: task.correct,
        x: Math.floor((task.percX / 100) * (internalWidth / cellSize)),
        y: Math.floor((task.percY / 100) * (internalHeight / cellSize)),
        done: false
      }));
      let currentTaskIndex = null;

      // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
      function drawGame() {
        let gradient = ctx.createLinearGradient(0, 0, internalWidth, internalHeight);
        gradient.addColorStop(0, '#89f7fe');
        gradient.addColorStop(1, '#66a6ff');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, internalWidth, internalHeight);

        tasks.forEach(task => {
          if (!task.done) {
            ctx.fillStyle = 'red';
            const centerX = task.x * cellSize + cellSize / 2;
            const centerY = task.y * cellSize + cellSize / 2;
            ctx.beginPath();
            ctx.arc(centerX, centerY, cellSize / 2, 0, Math.PI * 2);
            ctx.fill();
          }
        });

        snake.forEach((segment, index) => {
          ctx.fillStyle = index === 0 ? 'green' : 'lime';
          ctx.fillRect(segment.x * cellSize, segment.y * cellSize, cellSize, cellSize);
        });
      }

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      document.addEventListener('keydown', (e) => {
        if (gamePaused) return;
        switch (e.key) {
          case "ArrowUp":
            if (direction.y === 1) break;
            nextDirection = {x: 0, y: -1};
            break;
          case "ArrowDown":
            if (direction.y === -1) break;
            nextDirection = {x: 0, y: 1};
            break;
          case "ArrowLeft":
            if (direction.x === 1) break;
            nextDirection = {x: -1, y: 0};
            break;
          case "ArrowRight":
            if (direction.x === -1) break;
            nextDirection = {x: 1, y: 0};
            break;
        }
      });

      // –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
      function checkTaskCollision(newHead) {
        for (let i = 0; i < tasks.length; i++) {
          const task = tasks[i];
          if (!task.done && newHead.x === task.x && newHead.y === task.y) {
            return i;
          }
        }
        return -1;
      }

      function gameLoop() {
        if (gamePaused || gameOver) return;
        direction = nextDirection;
        const head = snake[0];
        const newHead = {x: head.x + direction.x, y: head.y + direction.y};

        newHead.x = (newHead.x + (internalWidth / cellSize)) % (internalWidth / cellSize);
        newHead.y = (newHead.y + (internalHeight / cellSize)) % (internalHeight / cellSize);

        for (let i = 0; i < snake.length; i++) {
          if (snake[i].x === newHead.x && snake[i].y === newHead.y) {
            endGame();
            return;
          }
        }

        snake.unshift(newHead);
        const taskIndex = checkTaskCollision(newHead);
        if (taskIndex !== -1) {
          gamePaused = true;
          currentTaskIndex = taskIndex;
          showQuestion(tasks[taskIndex].question);
        } else {
          snake.pop();
        }
        drawGame();
      }

      // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
      function showQuestion(question) {
        questionText.textContent = question;
        userAnswer.value = '';
        resultMessage.textContent = '';
        resultMessage.style.color = '#333';
        modalBg.style.display = 'flex';
      }

      function closeModal() {
        modalBg.style.display = 'none';
        currentTaskIndex = null;
        gamePaused = false;
        if (gameOver) {
          clearInterval(snakeGameInterval);
        }
      }

      function checkAnswer() {
        if (currentTaskIndex === null) return;
        const task = tasks[currentTaskIndex];
        const userAns = userAnswer.value.trim().toLowerCase();
        const correctAns = task.correct.toLowerCase();
        if (!userAns) {
          resultMessage.textContent = '–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç!';
          resultMessage.style.color = 'orange';
          return;
        }
        if (userAns === correctAns) {
          resultMessage.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! +1 –±–∞–ª–ª.';
          resultMessage.style.color = 'green';
          score++;
          sessionStorage.setItem('currentScore', score); // –î–æ–±–∞–≤–ª–µ–Ω–æ
          scoreBoard.textContent = 'Score: ' + score;
          task.done = true;
          setTimeout(() => {
            closeModal();
            if (tasks.every(t => t.done)) {
              endGame();
            }
          }, 1000);
        } else {
          resultMessage.textContent = '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ' + task.correct;
          resultMessage.style.color = 'red';
        }
      }

      checkBtn.addEventListener('click', checkAnswer);
      closeBtn.addEventListener('click', () => {
        closeModal();
      });

      // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
    function endGame() {
    updateBestScore();
     sessionStorage.removeItem('currentScore'); // –î–æ–±–∞–≤–ª–µ–Ω–æ: –æ—á–∏—Å—Ç–∫–∞
      gameOver = true;
      gamePaused = true;
      clearInterval(snakeGameInterval);
      questionText.textContent = "–í—Å–µ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∏–ª–∏ –∏–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!";
      userAnswer.style.display = 'none';
      checkBtn.style.display = 'none';
      resultMessage.textContent = '–í—ã –Ω–∞–±—Ä–∞–ª–∏ ' + score + ' –±–∞–ª–ª–æ–≤!';
      resultMessage.style.color = 'blue';
      modalBg.style.display = 'flex';

      const resultData = {
            game: currentGame,
            bestScore: bestScore  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–º–µ—Å—Ç–æ —Ç–µ–∫—É—â–µ–≥–æ —Å—á–µ—Ç–∞
      };

      if(typeof Telegram !== 'undefined' && Telegram.WebApp) {
            Telegram.WebApp.sendData(JSON.stringify(resultData));
      }
    }

      // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
      snakeGameInterval = setInterval(gameLoop, gameSpeed);
    }
    function updateScoreDisplay() {
        document.getElementById('scoreBoard').textContent = `Score: ${score}`;
        document.getElementById('bestScore').textContent = `Best: ${bestScore}`;
    }
</script>
</body>
</html>
